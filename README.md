# λ‚ μ”¨ μ£Όν–‰ λ°μ΄ν„°μ…‹ λ¶„λ¥ ν”„λ΅μ νΈ

λ‚ μ”¨ μ£Όν–‰ λ°μ΄ν„°μ…‹μ„ ν™μ©ν• λ©€ν‹° GPU ν•™μµ κµ¬ν„μ²΄μ…λ‹λ‹¤. λ³Έ ν”„λ΅μ νΈλ” MobileNetV3λ¥Ό μ‚¬μ©ν•μ—¬ μ£Όν–‰ μƒν™©μ—μ„μ λ‹¤μ–‘ν• λ‚ μ”¨ μ΅°κ±΄μ„ ν¨μ¨μ μΌλ΅ λ¶„λ¥ν•©λ‹λ‹¤.

## π μ£Όμ” κΈ°λ¥

- DistributedDataParallel (DDP)μ„ ν™μ©ν• λ©€ν‹° GPU ν•™μµ μ§€μ›
- MobileNetV3 λ°±λ³Έκ³Ό μ»¤μ¤ν…€ λ¶„λ¥κΈ° κµ¬ν„
- ν¨μ¨μ μΈ λ°μ΄ν„° λ΅λ”© λ° μ²λ¦¬
- ν¬κ΄„μ μΈ λ΅κΉ… μ‹μ¤ν…
- μλ™ μ²΄ν¬ν¬μΈνΈ μ €μ¥
- λ‹¤μ¤‘ GPU λ¶„μ‚° ν•™μµ μ§€μ›

## π“‹ ν•„μ” λΌμ΄λΈλ¬λ¦¬

```bash
torch>=2.0.0
torchvision>=0.15.0
lion-pytorch
pillow
tqdm
```

## π—‚ ν”„λ΅μ νΈ κµ¬μ΅°

```
.
β”β”€β”€ checkpoints/             # λ¨λΈ μ²΄ν¬ν¬μΈνΈ
β”β”€β”€ utils/
β”‚   β””β”€β”€ transform.py        # λ°μ΄ν„° λ³€ν™ μ ν‹Έλ¦¬ν‹°
β”β”€β”€ model_trainer.py        # μ£Όμ” ν•™μµ λ΅μ§
β””β”€β”€ main.py                # ν•™μµ μ‹¤ν–‰ μ¤ν¬λ¦½νΈ
```

## π€ λΉ λ¥Έ μ‹μ‘

1. **ν™κ²½ μ„¤μ •**
   ```bash
   pip install -r requirements.txt
   ```

2. **λ°μ΄ν„°μ…‹ μ¤€λΉ„**
   - λ°μ΄ν„°μ…‹μ„ λ‹¤μκ³Ό κ°™μ€ κµ¬μ΅°λ΅ λ°°μΉν•©λ‹λ‹¤:
   ```
   dataset/
   β”β”€β”€ Training/
   β”‚   β”β”€β”€ class1/
   β”‚   β”β”€β”€ class2/
   β”‚   β””β”€β”€ ...
   β””β”€β”€ Validation/
       β”β”€β”€ class1/
       β”β”€β”€ class2/
       β””β”€β”€ ...
   ```

3. **ν•™μµ μ‹μ‘**
   ```bash
   python main.py
   ```

## π’» λ©€ν‹° GPU ν•™μµ

λ³Έ κµ¬ν„μ²΄λ” λ‹¤μ¤‘ GPU λ¶„μ‚° ν•™μµμ„ μ§€μ›ν•©λ‹λ‹¤. μ½”λ“λ” μλ™μΌλ΅:
- κ°€μ© GPUμ— λ°μ΄ν„° λ¶„λ°°
- ν•™μµ μ¤‘ κ·Έλλ””μ–ΈνΈ λ™κΈ°ν™”
- λ§μ¤ν„° GPUμ—μ„ μ²΄ν¬ν¬μΈνΈ μ €μ¥μ„ κ΄€λ¦¬

GPU μ§€μ • λ°©λ²•:
```python
os.environ['CUDA_VISIBLE_DEVICES'] = '2,3,4,5'  # GPU 2,3,4,5 μ‚¬μ©
```

## π”§ μ„¤μ •

`main.py`μ μ£Όμ” μ„¤μ • μµμ…:

```python
# λ°μ΄ν„°μ…‹ μ„¤μ •
train_path = "D:/4type_weather_driving_dataset/Training"
valid_path = "D:/4type_weather_driving_dataset/Validation"
batch_size = 64
num_workers = 8

# ν•™μµ μ„¤μ •
num_epochs = 50
learning_rate = 1e-4
weight_decay = 1e-2

# λ¨λΈ μ„¤μ •
num_classes = 5
```

## π“ λ΅κΉ…

ν•™μµ κ³Όμ •μ€ μ½μ†”κ³Ό νμΌμ— λ¨λ‘ κΈ°λ΅λ©λ‹λ‹¤:
- ν•™μµ/κ²€μ¦ μ†μ‹¤
- μ •ν™•λ„ μ§€ν‘
- GPU ν• λ‹Ή μ •λ³΄
- μ¤λ¥ λ©”μ‹μ§€ λ° λ””λ²„κΉ… μ •λ³΄

λ΅κ·Έλ” `training.log`μ— μ €μ¥λ©λ‹λ‹¤.

## π’Ύ μ²΄ν¬ν¬μΈνΈ

κ²€μ¦ μ†μ‹¤μ΄ κ°μ„ λ  λ•λ§λ‹¤ λ¨λΈ μ²΄ν¬ν¬μΈνΈκ°€ μλ™μΌλ΅ μ €μ¥λ©λ‹λ‹¤. κ° μ²΄ν¬ν¬μΈνΈλ” λ‹¤μμ„ ν¬ν•¨ν•©λ‹λ‹¤:
- λ¨λΈ μƒνƒ μ‚¬μ „
- μµν‹°λ§μ΄μ € μƒνƒ
- μ¤μΌ€μ¤„λ¬ μƒνƒ
- ν•™μµ μ—ν¬ν¬ μ •λ³΄

## π¤ κΈ°μ—¬ν•κΈ°

κ°μ„ μ‚¬ν•­μ— λ€ν• μ΄μλ‚ ν’€ λ¦¬ν€μ¤νΈλ” μ–Έμ λ‚ ν™μν•©λ‹λ‹¤.

## π“ λΌμ΄μ„ μ¤

μ΄ ν”„λ΅μ νΈλ” MIT λΌμ΄μ„ μ¤λ¥Ό λ”°λ¦…λ‹λ‹¤ - μμ„Έν• λ‚΄μ©μ€ [LICENSE](LICENSE) νμΌμ„ μ°Έμ΅°ν•μ„Έμ”.

## π“ μ°Έκ³  μλ£

- [MobileNetV3 λ…Όλ¬Έ](https://arxiv.org/abs/1905.02244)
- [PyTorch λ¶„μ‚° ν•™μµ νν† λ¦¬μ–Ό](https://pytorch.org/tutorials/intermediate/ddp_tutorial.html)